<html>
  <head>
    <title>bost.ocks.org</title>
    <script type="text/javascript" src="nns.min.js?1.1.0"></script>
    <style type="text/css">

body {
  margin: 0;
}

#center {
  display: table;
  height: 100%;
  width: 100%;
  position: absolute;
}

#overlay {
  display: table-cell;
  vertical-align: middle;
  text-align: center;
  font: 120px Helvetica Neue;
  color: white;
  -webkit-text-stroke: 1px black;
  -moz-text-stroke: 1px black;
  text-shadow: 2px 2px 2px rgba(128, 128, 128, .4);
}

    </style>
  </head>
  <body>
    <div id="center">
      <div id="overlay">bost.ocks.org</div>
    </div>
    <script type="text/javascript">

var canvas = n$(document.body).add("canvas"),
    context = $n(canvas).getContext("2d"),
    rule = 105,
    state;

window.addEventListener("resize", resize, false);
resize();

function resize() {
  var w = document.body.clientWidth,
      h = document.body.clientHeight;

  canvas
      .attr("width", w)
      .attr("height", h);

  if (state) clearInterval(state.timer);

  state = {
    data: [],
    image: context.createImageData(w, 1),
    timer: setInterval(step, 40),
    i: 0,
    w: w,
    h: h
  };

  init(rule);
}

function init(x) {
  rule = x;
  state.i = 0;
  for (var j = 0; j < state.w; j++) {
    state.image.data[4 * j] = 255;
    state.image.data[4 * j + 1] = 255;
    state.image.data[4 * j + 2] = 255;
    state.image.data[4 * j + 3] = 255;
    state.data[j] = ~~(Math.random() * 2);
  }
}

function step() {
  context.putImageData(state.image, 0, state.i);

  if (state.i++ >= state.h) {
    init(~~(Math.random() * 256));
    return;
  }

  var p = state.data.slice();
  for (var j = 0; j < state.w; j++) {
    state.image.data[4 * j + 0]
        = state.image.data[4 * j + 1]
        = state.image.data[4 * j + 2]
        = 255 * (state.data[j]
        = (rule >> (p[j - 1] << 2 | p[j] << 1 | p[j + 1])) & 1);
  }
}

    </script>
  </body>
</html>
